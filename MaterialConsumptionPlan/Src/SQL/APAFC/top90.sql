
--AP TOP90
select EXPECTED_SHIP_PLANT,
VENDOR_NAME,
MATERIALID,
MRP_CONTROLLER,
SUPPLY_PLANT_MRPCONT,
STRATEGY_GRP,
PROD_BU,
SUPPLY_PLANT_PROD_SCHED,
TOTAL_BASE_ORDER_QTY_WK13,
TOTAL_BASE_ORDER_QTY_WK12,
TOTAL_BASE_ORDER_QTY_WK11,
TOTAL_BASE_ORDER_QTY_WK10,
TOTAL_BASE_ORDER_QTY_WK09,
TOTAL_BASE_ORDER_QTY_WK08,
TOTAL_BASE_ORDER_QTY_WK07,
TOTAL_BASE_ORDER_QTY_WK06,
TOTAL_BASE_ORDER_QTY_WK05,
TOTAL_BASE_ORDER_QTY_WK04,
TOTAL_BASE_ORDER_QTY_WK03,
TOTAL_BASE_ORDER_QTY_WK02,
TOTAL_BASE_ORDER_QTY_WK01,
STO_BASE_ORDER_QTY_WK13,
STO_BASE_ORDER_QTY_WK12,
STO_BASE_ORDER_QTY_WK11,
STO_BASE_ORDER_QTY_WK10,
STO_BASE_ORDER_QTY_WK09,
STO_BASE_ORDER_QTY_WK08,
STO_BASE_ORDER_QTY_WK07,
STO_BASE_ORDER_QTY_WK06,
STO_BASE_ORDER_QTY_WK05,
STO_BASE_ORDER_QTY_WK04,
STO_BASE_ORDER_QTY_WK03,
STO_BASE_ORDER_QTY_WK02,
STO_BASE_ORDER_QTY_WK01,
SALES_BASE_ORDER_QTY_WK13,
SALES_BASE_ORDER_QTY_WK12,
SALES_BASE_ORDER_QTY_WK11,
SALES_BASE_ORDER_QTY_WK10,
SALES_BASE_ORDER_QTY_WK09,
SALES_BASE_ORDER_QTY_WK08,
SALES_BASE_ORDER_QTY_WK07,
SALES_BASE_ORDER_QTY_WK06,
SALES_BASE_ORDER_QTY_WK05,
SALES_BASE_ORDER_QTY_WK04,
SALES_BASE_ORDER_QTY_WK03,
SALES_BASE_ORDER_QTY_WK02,
SALES_BASE_ORDER_QTY_WK01,
FRCST_00_PLAN_QTY_FUT_WK01,
FRCST_00_PLAN_QTY_FUT_WK02,
FRCST_00_PLAN_QTY_FUT_WK03,
FRCST_00_PLAN_QTY_FUT_WK04,
FRCST_00_PLAN_QTY_FUT_WK05,
FRCST_00_PLAN_QTY_FUT_WK06,
FRCST_00_PLAN_QTY_FUT_WK07,
FRCST_00_PLAN_QTY_FUT_WK08,
FRCST_00_PLAN_QTY_FUT_WK09,
FRCST_00_PLAN_QTY_FUT_WK10,
FRCST_00_PLAN_QTY_FUT_WK11,
FRCST_00_PLAN_QTY_FUT_WK12,
FRCST_00_PLAN_QTY_FUT_WK13,
FRCST_55_PLAN_QTY_FUT_WK01,
FRCST_55_PLAN_QTY_FUT_WK02,
FRCST_55_PLAN_QTY_FUT_WK03,
FRCST_55_PLAN_QTY_FUT_WK04,
FRCST_55_PLAN_QTY_FUT_WK05,
FRCST_55_PLAN_QTY_FUT_WK06,
FRCST_55_PLAN_QTY_FUT_WK07,
FRCST_55_PLAN_QTY_FUT_WK08,
FRCST_55_PLAN_QTY_FUT_WK09,
FRCST_55_PLAN_QTY_FUT_WK10,
FRCST_55_PLAN_QTY_FUT_WK11,
FRCST_55_PLAN_QTY_FUT_WK12,
FRCST_55_PLAN_QTY_FUT_WK13,
FRCST_AA_PLAN_QTY_FUT_WK01,
FRCST_AA_PLAN_QTY_FUT_WK02,
FRCST_AA_PLAN_QTY_FUT_WK03,
FRCST_AA_PLAN_QTY_FUT_WK04,
FRCST_AA_PLAN_QTY_FUT_WK05,
FRCST_AA_PLAN_QTY_FUT_WK06,
FRCST_AA_PLAN_QTY_FUT_WK07,
FRCST_AA_PLAN_QTY_FUT_WK08,
FRCST_AA_PLAN_QTY_FUT_WK09,
FRCST_AA_PLAN_QTY_FUT_WK10,
FRCST_AA_PLAN_QTY_FUT_WK11,
FRCST_AA_PLAN_QTY_FUT_WK12,
FRCST_AA_PLAN_QTY_FUT_WK13,
FRCST_00_PLAN_QTY_FUT_WK01 + FRCST_AA_PLAN_QTY_FUT_WK01 as Planned_Load_WK01,
FRCST_00_PLAN_QTY_FUT_WK02 + FRCST_AA_PLAN_QTY_FUT_WK02 as Planned_Load_WK02,
FRCST_00_PLAN_QTY_FUT_WK03 + FRCST_AA_PLAN_QTY_FUT_WK03 as Planned_Load_WK03,
FRCST_00_PLAN_QTY_FUT_WK04 + FRCST_AA_PLAN_QTY_FUT_WK04 as Planned_Load_WK04,
FRCST_00_PLAN_QTY_FUT_WK05 + FRCST_AA_PLAN_QTY_FUT_WK05 as Planned_Load_WK05,
FRCST_00_PLAN_QTY_FUT_WK06 + FRCST_AA_PLAN_QTY_FUT_WK06 as Planned_Load_WK06,
FRCST_00_PLAN_QTY_FUT_WK07 + FRCST_AA_PLAN_QTY_FUT_WK07 as Planned_Load_WK07,
FRCST_00_PLAN_QTY_FUT_WK08 + FRCST_AA_PLAN_QTY_FUT_WK08 as Planned_Load_WK08,
FRCST_00_PLAN_QTY_FUT_WK09 + FRCST_AA_PLAN_QTY_FUT_WK09 as Planned_Load_WK09,
FRCST_00_PLAN_QTY_FUT_WK10 + FRCST_AA_PLAN_QTY_FUT_WK10 as Planned_Load_WK10,
FRCST_00_PLAN_QTY_FUT_WK11 + FRCST_AA_PLAN_QTY_FUT_WK11 as Planned_Load_WK11,
FRCST_00_PLAN_QTY_FUT_WK12 + FRCST_AA_PLAN_QTY_FUT_WK12 as Planned_Load_WK12,
FRCST_00_PLAN_QTY_FUT_WK13 + FRCST_AA_PLAN_QTY_FUT_WK13 as Planned_Load_WK13,
GOOD_LINES_LAST_WEEK_COMMIT,
BAD_LINES_LAST_WEEK_COMMIT,
TARGET_LINES_LAST_WEEK,
TOTAL_LINES_LAST_WEEK_COMMIT,
(TOTAL_BASE_ORDER_QTY_WK13 + TOTAL_BASE_ORDER_QTY_WK12 + TOTAL_BASE_ORDER_QTY_WK11 + TOTAL_BASE_ORDER_QTY_WK10 + TOTAL_BASE_ORDER_QTY_WK09 + TOTAL_BASE_ORDER_QTY_WK08 + TOTAL_BASE_ORDER_QTY_WK07 + TOTAL_BASE_ORDER_QTY_WK06 + TOTAL_BASE_ORDER_QTY_WK05 + TOTAL_BASE_ORDER_QTY_WK04 + TOTAL_BASE_ORDER_QTY_WK03 + TOTAL_BASE_ORDER_QTY_WK02 + TOTAL_BASE_ORDER_QTY_WK01) as COGS, 
((TOTAL_BASE_ORDER_QTY_WK13 + TOTAL_BASE_ORDER_QTY_WK12 + TOTAL_BASE_ORDER_QTY_WK11 + TOTAL_BASE_ORDER_QTY_WK10 + TOTAL_BASE_ORDER_QTY_WK09 + TOTAL_BASE_ORDER_QTY_WK08 + TOTAL_BASE_ORDER_QTY_WK07 + TOTAL_BASE_ORDER_QTY_WK06 + TOTAL_BASE_ORDER_QTY_WK05 + TOTAL_BASE_ORDER_QTY_WK04 + TOTAL_BASE_ORDER_QTY_WK03 + TOTAL_BASE_ORDER_QTY_WK02 + TOTAL_BASE_ORDER_QTY_WK01) * UNIT_COST) as COGS$$,
SAFETY_STK,
LOT_SIZE,
UNIT_COST,
SAFETY_STK as MIN_INVENTORY,
((0.5 * LOT_SIZE)+ SAFETY_STK) as TARGET_INVENTORY_QTY,
((1 * LOT_SIZE) + SAFETY_STK) as MAX_INVENTORY_QTY,
DC_OH_QTY,
(SAFETY_STK * UNIT_COST) as MIN_INVENTORY_$$,
(((0.5 * LOT_SIZE)+ SAFETY_STK) * UNIT_COST) as TARGET_INVENTORY_$$,
(((1 * LOT_SIZE) + SAFETY_STK) * UNIT_COST) as MAX_INVENTORY_$$,
DC_OH_QTY * UNIT_COST as OH_INVENTORY_$$,
DC_OH_QTY - TARGET_INVENTORY_RANK_WK_13 as OVER_TARGET_QTY,
DC_OH_QTY - MAX_INVENTORY_RANK_WK_13 as OVER_MAX_QTY,
(DC_OH_QTY - TARGET_INVENTORY_RANK_WK_13) * UNIT_COST as OVER_TARGET_$$,
(DC_OH_QTY - MAX_INVENTORY_RANK_WK_13) * UNIT_COST as OVER_MAX_$$,
OH_WEEK12,
OH_WEEK11,
OH_WEEK10,
OH_WEEK09,
OH_WEEK08,
OH_WEEK07,
OH_WEEK06,
OH_WEEK05,
OH_WEEK04,
OH_WEEK03,
OH_WEEK02,
OH_WEEK01,
DC_OH_QTY as OH_QTY_CURR_WEEK,
MAX_INVENTORY_RANK_WK_12,
MAX_INVENTORY_RANK_WK_11,
MAX_INVENTORY_RANK_WK_10,
MAX_INVENTORY_RANK_WK_09,
MAX_INVENTORY_RANK_WK_08,
MAX_INVENTORY_RANK_WK_07,
MAX_INVENTORY_RANK_WK_06,
MAX_INVENTORY_RANK_WK_05,
MAX_INVENTORY_RANK_WK_04,
MAX_INVENTORY_RANK_WK_03,
MAX_INVENTORY_RANK_WK_02,
MAX_INVENTORY_RANK_WK_01,
((1 * LOT_SIZE) + SAFETY_STK) as MAX_INVENTORY_QTY_CURR_WEEK,
TARGET_INVENTORY_RANK_WK_12,
TARGET_INVENTORY_RANK_WK_11,
TARGET_INVENTORY_RANK_WK_10,
TARGET_INVENTORY_RANK_WK_09,
TARGET_INVENTORY_RANK_WK_08,
TARGET_INVENTORY_RANK_WK_07,
TARGET_INVENTORY_RANK_WK_06,
TARGET_INVENTORY_RANK_WK_05,
TARGET_INVENTORY_RANK_WK_04,
TARGET_INVENTORY_RANK_WK_03,
TARGET_INVENTORY_RANK_WK_02,
TARGET_INVENTORY_RANK_WK_01,
((0.5 * LOT_SIZE)+ SAFETY_STK) as TARGET_INVENTORY_QTY_CURR_WEEK,
MIN_INVENTORY_RANK_WK_12,
MIN_INVENTORY_RANK_WK_11,
MIN_INVENTORY_RANK_WK_10,
MIN_INVENTORY_RANK_WK_09,
MIN_INVENTORY_RANK_WK_08,
MIN_INVENTORY_RANK_WK_07,
MIN_INVENTORY_RANK_WK_06,
MIN_INVENTORY_RANK_WK_05,
MIN_INVENTORY_RANK_WK_04,
MIN_INVENTORY_RANK_WK_03,
MIN_INVENTORY_RANK_WK_02,
MIN_INVENTORY_RANK_WK_01,
SAFETY_STK as MIN_INVENTORY_QTY_CURR_WEEK,
OH_WEEK12_$$,
OH_WEEK11_$$,
OH_WEEK10_$$,
OH_WEEK09_$$,
OH_WEEK08_$$,
OH_WEEK07_$$,
OH_WEEK06_$$,
OH_WEEK05_$$,
OH_WEEK04_$$,
OH_WEEK03_$$,
OH_WEEK02_$$,
OH_WEEK01_$$,
(DC_OH_QTY * UNIT_COST)as OH_CURR_WEEK_$$,
TARGET_INVENTORY_RANK_WK_12 * UNIT_COST as TARGET_INVENTORY_RANK_WK_12_$$,
TARGET_INVENTORY_RANK_WK_11 * UNIT_COST as TARGET_INVENTORY_RANK_WK_11_$$,
TARGET_INVENTORY_RANK_WK_10 * UNIT_COST as TARGET_INVENTORY_RANK_WK_10_$$,
TARGET_INVENTORY_RANK_WK_09 * UNIT_COST as TARGET_INVENTORY_RANK_WK_09_$$,
TARGET_INVENTORY_RANK_WK_08 * UNIT_COST as TARGET_INVENTORY_RANK_WK_08_$$,
TARGET_INVENTORY_RANK_WK_07 * UNIT_COST as TARGET_INVENTORY_RANK_WK_07_$$,
TARGET_INVENTORY_RANK_WK_06 * UNIT_COST as TARGET_INVENTORY_RANK_WK_06_$$,
TARGET_INVENTORY_RANK_WK_05 * UNIT_COST as TARGET_INVENTORY_RANK_WK_05_$$,
TARGET_INVENTORY_RANK_WK_04 * UNIT_COST as TARGET_INVENTORY_RANK_WK_04_$$,
TARGET_INVENTORY_RANK_WK_03 * UNIT_COST as TARGET_INVENTORY_RANK_WK_03_$$,
TARGET_INVENTORY_RANK_WK_02 * UNIT_COST as TARGET_INVENTORY_RANK_WK_02_$$,
TARGET_INVENTORY_RANK_WK_01 * UNIT_COST as TARGET_INVENTORY_RANK_WK_01_$$,
(((0.5 * LOT_SIZE)+ SAFETY_STK) * UNIT_COST) as TARGET_INVENTORY_CURR_WEEK_$$
from DWQ$LIBRARIAN.INV_SAP_TOP_90_BUILD@ROCKWELL_DW_DBLINK
where EXPECTED_SHIP_PLANT in  ('5040','5050','5070','5100','5110','5120','5140','5160','5190','5200');


















--JQS&JQD TOP90
select EXPECTED_SHIP_PLANT,
VENDOR_NAME,
MATERIALID,
MRP_CONTROLLER,
SUPPLY_PLANT_MRPCONT,
STRATEGY_GRP,
PROD_BU,
SUPPLY_PLANT_PROD_SCHED,
TOTAL_BASE_ORDER_QTY_WK13,
TOTAL_BASE_ORDER_QTY_WK12,
TOTAL_BASE_ORDER_QTY_WK11,
TOTAL_BASE_ORDER_QTY_WK10,
TOTAL_BASE_ORDER_QTY_WK09,
TOTAL_BASE_ORDER_QTY_WK08,
TOTAL_BASE_ORDER_QTY_WK07,
TOTAL_BASE_ORDER_QTY_WK06,
TOTAL_BASE_ORDER_QTY_WK05,
TOTAL_BASE_ORDER_QTY_WK04,
TOTAL_BASE_ORDER_QTY_WK03,
TOTAL_BASE_ORDER_QTY_WK02,
TOTAL_BASE_ORDER_QTY_WK01,
STO_BASE_ORDER_QTY_WK13,
STO_BASE_ORDER_QTY_WK12,
STO_BASE_ORDER_QTY_WK11,
STO_BASE_ORDER_QTY_WK10,
STO_BASE_ORDER_QTY_WK09,
STO_BASE_ORDER_QTY_WK08,
STO_BASE_ORDER_QTY_WK07,
STO_BASE_ORDER_QTY_WK06,
STO_BASE_ORDER_QTY_WK05,
STO_BASE_ORDER_QTY_WK04,
STO_BASE_ORDER_QTY_WK03,
STO_BASE_ORDER_QTY_WK02,
STO_BASE_ORDER_QTY_WK01,
SALES_BASE_ORDER_QTY_WK13,
SALES_BASE_ORDER_QTY_WK12,
SALES_BASE_ORDER_QTY_WK11,
SALES_BASE_ORDER_QTY_WK10,
SALES_BASE_ORDER_QTY_WK09,
SALES_BASE_ORDER_QTY_WK08,
SALES_BASE_ORDER_QTY_WK07,
SALES_BASE_ORDER_QTY_WK06,
SALES_BASE_ORDER_QTY_WK05,
SALES_BASE_ORDER_QTY_WK04,
SALES_BASE_ORDER_QTY_WK03,
SALES_BASE_ORDER_QTY_WK02,
SALES_BASE_ORDER_QTY_WK01,
FRCST_00_PLAN_QTY_FUT_WK01,
FRCST_00_PLAN_QTY_FUT_WK02,
FRCST_00_PLAN_QTY_FUT_WK03,
FRCST_00_PLAN_QTY_FUT_WK04,
FRCST_00_PLAN_QTY_FUT_WK05,
FRCST_00_PLAN_QTY_FUT_WK06,
FRCST_00_PLAN_QTY_FUT_WK07,
FRCST_00_PLAN_QTY_FUT_WK08,
FRCST_00_PLAN_QTY_FUT_WK09,
FRCST_00_PLAN_QTY_FUT_WK10,
FRCST_00_PLAN_QTY_FUT_WK11,
FRCST_00_PLAN_QTY_FUT_WK12,
FRCST_00_PLAN_QTY_FUT_WK13,
FRCST_55_PLAN_QTY_FUT_WK01,
FRCST_55_PLAN_QTY_FUT_WK02,
FRCST_55_PLAN_QTY_FUT_WK03,
FRCST_55_PLAN_QTY_FUT_WK04,
FRCST_55_PLAN_QTY_FUT_WK05,
FRCST_55_PLAN_QTY_FUT_WK06,
FRCST_55_PLAN_QTY_FUT_WK07,
FRCST_55_PLAN_QTY_FUT_WK08,
FRCST_55_PLAN_QTY_FUT_WK09,
FRCST_55_PLAN_QTY_FUT_WK10,
FRCST_55_PLAN_QTY_FUT_WK11,
FRCST_55_PLAN_QTY_FUT_WK12,
FRCST_55_PLAN_QTY_FUT_WK13,
FRCST_AA_PLAN_QTY_FUT_WK01,
FRCST_AA_PLAN_QTY_FUT_WK02,
FRCST_AA_PLAN_QTY_FUT_WK03,
FRCST_AA_PLAN_QTY_FUT_WK04,
FRCST_AA_PLAN_QTY_FUT_WK05,
FRCST_AA_PLAN_QTY_FUT_WK06,
FRCST_AA_PLAN_QTY_FUT_WK07,
FRCST_AA_PLAN_QTY_FUT_WK08,
FRCST_AA_PLAN_QTY_FUT_WK09,
FRCST_AA_PLAN_QTY_FUT_WK10,
FRCST_AA_PLAN_QTY_FUT_WK11,
FRCST_AA_PLAN_QTY_FUT_WK12,
FRCST_AA_PLAN_QTY_FUT_WK13,
FRCST_00_PLAN_QTY_FUT_WK01 + FRCST_AA_PLAN_QTY_FUT_WK01 as Planned_Load_WK01,
FRCST_00_PLAN_QTY_FUT_WK02 + FRCST_AA_PLAN_QTY_FUT_WK02 as Planned_Load_WK02,
FRCST_00_PLAN_QTY_FUT_WK03 + FRCST_AA_PLAN_QTY_FUT_WK03 as Planned_Load_WK03,
FRCST_00_PLAN_QTY_FUT_WK04 + FRCST_AA_PLAN_QTY_FUT_WK04 as Planned_Load_WK04,
FRCST_00_PLAN_QTY_FUT_WK05 + FRCST_AA_PLAN_QTY_FUT_WK05 as Planned_Load_WK05,
FRCST_00_PLAN_QTY_FUT_WK06 + FRCST_AA_PLAN_QTY_FUT_WK06 as Planned_Load_WK06,
FRCST_00_PLAN_QTY_FUT_WK07 + FRCST_AA_PLAN_QTY_FUT_WK07 as Planned_Load_WK07,
FRCST_00_PLAN_QTY_FUT_WK08 + FRCST_AA_PLAN_QTY_FUT_WK08 as Planned_Load_WK08,
FRCST_00_PLAN_QTY_FUT_WK09 + FRCST_AA_PLAN_QTY_FUT_WK09 as Planned_Load_WK09,
FRCST_00_PLAN_QTY_FUT_WK10 + FRCST_AA_PLAN_QTY_FUT_WK10 as Planned_Load_WK10,
FRCST_00_PLAN_QTY_FUT_WK11 + FRCST_AA_PLAN_QTY_FUT_WK11 as Planned_Load_WK11,
FRCST_00_PLAN_QTY_FUT_WK12 + FRCST_AA_PLAN_QTY_FUT_WK12 as Planned_Load_WK12,
FRCST_00_PLAN_QTY_FUT_WK13 + FRCST_AA_PLAN_QTY_FUT_WK13 as Planned_Load_WK13,
STO_BASE_OPEN_QTY_FUT_WK01,
STO_BASE_OPEN_QTY_FUT_WK02,
STO_BASE_OPEN_QTY_FUT_WK03,
STO_BASE_OPEN_QTY_FUT_WK04,
STO_BASE_OPEN_QTY_FUT_WK05,
STO_BASE_OPEN_QTY_FUT_WK06,
STO_BASE_OPEN_QTY_FUT_WK07,
STO_BASE_OPEN_QTY_FUT_WK08,
STO_BASE_OPEN_QTY_FUT_WK09,
STO_BASE_OPEN_QTY_FUT_WK10,
STO_BASE_OPEN_QTY_FUT_WK11,
STO_BASE_OPEN_QTY_FUT_WK12,
STO_BASE_OPEN_QTY_FUT_WK13,
STO_PLAN_QTY_FUT_WK01,
STO_PLAN_QTY_FUT_WK02,
STO_PLAN_QTY_FUT_WK03,
STO_PLAN_QTY_FUT_WK04,
STO_PLAN_QTY_FUT_WK05,
STO_PLAN_QTY_FUT_WK06,
STO_PLAN_QTY_FUT_WK07,
STO_PLAN_QTY_FUT_WK08,
STO_PLAN_QTY_FUT_WK09,
STO_PLAN_QTY_FUT_WK10,
STO_PLAN_QTY_FUT_WK11,
STO_PLAN_QTY_FUT_WK12,
STO_PLAN_QTY_FUT_WK13,
GOOD_LINES_LAST_WEEK_COMMIT,
BAD_LINES_LAST_WEEK_COMMIT,
TARGET_LINES_LAST_WEEK,
TOTAL_LINES_LAST_WEEK_COMMIT,
(TOTAL_BASE_ORDER_QTY_WK13 + TOTAL_BASE_ORDER_QTY_WK12 + TOTAL_BASE_ORDER_QTY_WK11 + TOTAL_BASE_ORDER_QTY_WK10 + TOTAL_BASE_ORDER_QTY_WK09 + TOTAL_BASE_ORDER_QTY_WK08 + TOTAL_BASE_ORDER_QTY_WK07 + TOTAL_BASE_ORDER_QTY_WK06 + TOTAL_BASE_ORDER_QTY_WK05 + TOTAL_BASE_ORDER_QTY_WK04 + TOTAL_BASE_ORDER_QTY_WK03 + TOTAL_BASE_ORDER_QTY_WK02 + TOTAL_BASE_ORDER_QTY_WK01) as COGS, 
((TOTAL_BASE_ORDER_QTY_WK13 + TOTAL_BASE_ORDER_QTY_WK12 + TOTAL_BASE_ORDER_QTY_WK11 + TOTAL_BASE_ORDER_QTY_WK10 + TOTAL_BASE_ORDER_QTY_WK09 + TOTAL_BASE_ORDER_QTY_WK08 + TOTAL_BASE_ORDER_QTY_WK07 + TOTAL_BASE_ORDER_QTY_WK06 + TOTAL_BASE_ORDER_QTY_WK05 + TOTAL_BASE_ORDER_QTY_WK04 + TOTAL_BASE_ORDER_QTY_WK03 + TOTAL_BASE_ORDER_QTY_WK02 + TOTAL_BASE_ORDER_QTY_WK01) * UNIT_COST) as COGS$$,
((TOTAL_BASE_ORDER_QTY_WK04 + TOTAL_BASE_ORDER_QTY_WK03 + TOTAL_BASE_ORDER_QTY_WK02 + TOTAL_BASE_ORDER_QTY_WK01)/4) as Four_Weeks_Intake_STO,
((TOTAL_BASE_ORDER_QTY_WK08 + TOTAL_BASE_ORDER_QTY_WK07 + TOTAL_BASE_ORDER_QTY_WK06 + TOTAL_BASE_ORDER_QTY_WK05 + TOTAL_BASE_ORDER_QTY_WK04 + TOTAL_BASE_ORDER_QTY_WK03 + TOTAL_BASE_ORDER_QTY_WK02 + TOTAL_BASE_ORDER_QTY_WK01)/8) as Eight_Weeks_Intake_STO,
((TOTAL_BASE_ORDER_QTY_WK13 + TOTAL_BASE_ORDER_QTY_WK12 + TOTAL_BASE_ORDER_QTY_WK11 + TOTAL_BASE_ORDER_QTY_WK10 + TOTAL_BASE_ORDER_QTY_WK09 + TOTAL_BASE_ORDER_QTY_WK08 + TOTAL_BASE_ORDER_QTY_WK07 + TOTAL_BASE_ORDER_QTY_WK06 + TOTAL_BASE_ORDER_QTY_WK05 + TOTAL_BASE_ORDER_QTY_WK04 + TOTAL_BASE_ORDER_QTY_WK03 + TOTAL_BASE_ORDER_QTY_WK02 + TOTAL_BASE_ORDER_QTY_WK01)/13) as Thirteen_Weeks_Intake_STO, 
((SALES_BASE_ORDER_QTY_WK04 + SALES_BASE_ORDER_QTY_WK03 + SALES_BASE_ORDER_QTY_WK02 + SALES_BASE_ORDER_QTY_WK01)/4) as Four_Weeks_Intake,
((SALES_BASE_ORDER_QTY_WK08 + SALES_BASE_ORDER_QTY_WK07 + SALES_BASE_ORDER_QTY_WK06 + SALES_BASE_ORDER_QTY_WK05 + SALES_BASE_ORDER_QTY_WK04 + SALES_BASE_ORDER_QTY_WK03 + SALES_BASE_ORDER_QTY_WK02 + SALES_BASE_ORDER_QTY_WK01)/8) as Eight_Weeks_Intake,
((SALES_BASE_ORDER_QTY_WK13 + SALES_BASE_ORDER_QTY_WK12 + SALES_BASE_ORDER_QTY_WK11 + SALES_BASE_ORDER_QTY_WK10 + SALES_BASE_ORDER_QTY_WK09 + SALES_BASE_ORDER_QTY_WK08 + SALES_BASE_ORDER_QTY_WK07 + SALES_BASE_ORDER_QTY_WK06 + SALES_BASE_ORDER_QTY_WK05 + SALES_BASE_ORDER_QTY_WK04 + SALES_BASE_ORDER_QTY_WK03 + SALES_BASE_ORDER_QTY_WK02 + SALES_BASE_ORDER_QTY_WK01)/13) as Thirteen_Weeks_Intake,
((FRCST_00_PLAN_QTY_FUT_WK02 + FRCST_00_PLAN_QTY_FUT_WK03 + FRCST_00_PLAN_QTY_FUT_WK04 + FRCST_00_PLAN_QTY_FUT_WK05)/4) as Four_Weeks_V00,
((FRCST_00_PLAN_QTY_FUT_WK02 + FRCST_00_PLAN_QTY_FUT_WK03 + FRCST_00_PLAN_QTY_FUT_WK04 + FRCST_00_PLAN_QTY_FUT_WK05 + FRCST_00_PLAN_QTY_FUT_WK06 + FRCST_00_PLAN_QTY_FUT_WK07 + FRCST_00_PLAN_QTY_FUT_WK08 + FRCST_00_PLAN_QTY_FUT_WK09)/8) as Eight_Weeks_V00,
((FRCST_00_PLAN_QTY_FUT_WK02 + FRCST_00_PLAN_QTY_FUT_WK03 + FRCST_00_PLAN_QTY_FUT_WK04 + FRCST_00_PLAN_QTY_FUT_WK05 + FRCST_00_PLAN_QTY_FUT_WK06 + FRCST_00_PLAN_QTY_FUT_WK07 + FRCST_00_PLAN_QTY_FUT_WK08 + FRCST_00_PLAN_QTY_FUT_WK09 + FRCST_00_PLAN_QTY_FUT_WK10 + FRCST_00_PLAN_QTY_FUT_WK11 + FRCST_00_PLAN_QTY_FUT_WK12 + FRCST_00_PLAN_QTY_FUT_WK13)/12) as Twelve_Weeks_V00,
((FRCST_55_PLAN_QTY_FUT_WK01 + FRCST_55_PLAN_QTY_FUT_WK02 + FRCST_55_PLAN_QTY_FUT_WK03 + FRCST_55_PLAN_QTY_FUT_WK04 + FRCST_55_PLAN_QTY_FUT_WK05 + FRCST_55_PLAN_QTY_FUT_WK06 + FRCST_55_PLAN_QTY_FUT_WK07 + FRCST_55_PLAN_QTY_FUT_WK08 + FRCST_55_PLAN_QTY_FUT_WK09 + FRCST_55_PLAN_QTY_FUT_WK10 + FRCST_55_PLAN_QTY_FUT_WK11 + FRCST_55_PLAN_QTY_FUT_WK12 + FRCST_55_PLAN_QTY_FUT_WK13)/13) as Thirteen_Weeks_V55,
--((((Four_Weeks_V00 + Eight_Weeks_V00)/2) - ((Four_Weeks_Intake + Eight_Weeks_Intake)/2))* UNIT_COST) as V00_to_Intake_$_Difference,
--((Thirteen_Weeks_V55 - ((Four_Weeks_Intake + Eight_Weeks_Intake)/2))* UNIT_COST) as V55_to_Intake_$_Difference,
--((((Four_Weeks_V00 + Eight_Weeks_V00)/2) - ((Four_Weeks_Intake + Eight_Weeks_Intake)/2))/((Four_Weeks_V00 + Eight_Weeks_V00)/2)) as V00_to_Intake_Percentage_Diff,
--((Thirteen_Weeks_V55 - ((Four_Weeks_Intake + Eight_Weeks_Intake)/2))/ Thirteen_Weeks_V55) as V55_to_Intake_Percentage_Diff,
((((((FRCST_00_PLAN_QTY_FUT_WK02 + FRCST_00_PLAN_QTY_FUT_WK03 + FRCST_00_PLAN_QTY_FUT_WK04 + FRCST_00_PLAN_QTY_FUT_WK05)/4) + ((FRCST_00_PLAN_QTY_FUT_WK02 + FRCST_00_PLAN_QTY_FUT_WK03 + FRCST_00_PLAN_QTY_FUT_WK04 + FRCST_00_PLAN_QTY_FUT_WK05 + FRCST_00_PLAN_QTY_FUT_WK06 + FRCST_00_PLAN_QTY_FUT_WK07 + FRCST_00_PLAN_QTY_FUT_WK08 + FRCST_00_PLAN_QTY_FUT_WK09)/8))/2) - ((((SALES_BASE_ORDER_QTY_WK04 + SALES_BASE_ORDER_QTY_WK03 + SALES_BASE_ORDER_QTY_WK02 + SALES_BASE_ORDER_QTY_WK01)/4) + ((SALES_BASE_ORDER_QTY_WK08 + SALES_BASE_ORDER_QTY_WK07 + SALES_BASE_ORDER_QTY_WK06 + SALES_BASE_ORDER_QTY_WK05 + SALES_BASE_ORDER_QTY_WK04 + SALES_BASE_ORDER_QTY_WK03 + SALES_BASE_ORDER_QTY_WK02 + SALES_BASE_ORDER_QTY_WK01)/8))/2))* UNIT_COST) as V00_to_Intake_$_Difference,
((((FRCST_55_PLAN_QTY_FUT_WK01 + FRCST_55_PLAN_QTY_FUT_WK02 + FRCST_55_PLAN_QTY_FUT_WK03 + FRCST_55_PLAN_QTY_FUT_WK04 + FRCST_55_PLAN_QTY_FUT_WK05 + FRCST_55_PLAN_QTY_FUT_WK06 + FRCST_55_PLAN_QTY_FUT_WK07 + FRCST_55_PLAN_QTY_FUT_WK08 + FRCST_55_PLAN_QTY_FUT_WK09 + FRCST_55_PLAN_QTY_FUT_WK10 + FRCST_55_PLAN_QTY_FUT_WK11 + FRCST_55_PLAN_QTY_FUT_WK12 + FRCST_55_PLAN_QTY_FUT_WK13)/13) - ((((SALES_BASE_ORDER_QTY_WK04 + SALES_BASE_ORDER_QTY_WK03 + SALES_BASE_ORDER_QTY_WK02 + SALES_BASE_ORDER_QTY_WK01)/4) + ((SALES_BASE_ORDER_QTY_WK08 + SALES_BASE_ORDER_QTY_WK07 + SALES_BASE_ORDER_QTY_WK06 + SALES_BASE_ORDER_QTY_WK05 + SALES_BASE_ORDER_QTY_WK04 + SALES_BASE_ORDER_QTY_WK03 + SALES_BASE_ORDER_QTY_WK02 + SALES_BASE_ORDER_QTY_WK01)/8))/2))* UNIT_COST) as V55_to_Intake_$_Difference,

DECODE(((((FRCST_00_PLAN_QTY_FUT_WK02 + FRCST_00_PLAN_QTY_FUT_WK03 + FRCST_00_PLAN_QTY_FUT_WK04 + FRCST_00_PLAN_QTY_FUT_WK05)/4) + ((FRCST_00_PLAN_QTY_FUT_WK02 + FRCST_00_PLAN_QTY_FUT_WK03 + FRCST_00_PLAN_QTY_FUT_WK04 + FRCST_00_PLAN_QTY_FUT_WK05 + FRCST_00_PLAN_QTY_FUT_WK06 + FRCST_00_PLAN_QTY_FUT_WK07 + FRCST_00_PLAN_QTY_FUT_WK08 + FRCST_00_PLAN_QTY_FUT_WK09)/8))/2),0,0,((((((FRCST_00_PLAN_QTY_FUT_WK02 + FRCST_00_PLAN_QTY_FUT_WK03 + FRCST_00_PLAN_QTY_FUT_WK04 + FRCST_00_PLAN_QTY_FUT_WK05)/4) + ((FRCST_00_PLAN_QTY_FUT_WK02 + FRCST_00_PLAN_QTY_FUT_WK03 + FRCST_00_PLAN_QTY_FUT_WK04 + FRCST_00_PLAN_QTY_FUT_WK05 + FRCST_00_PLAN_QTY_FUT_WK06 + FRCST_00_PLAN_QTY_FUT_WK07 + FRCST_00_PLAN_QTY_FUT_WK08 + FRCST_00_PLAN_QTY_FUT_WK09)/8))/2) - ((((SALES_BASE_ORDER_QTY_WK04 + SALES_BASE_ORDER_QTY_WK03 + SALES_BASE_ORDER_QTY_WK02 + SALES_BASE_ORDER_QTY_WK01)/4) + ((SALES_BASE_ORDER_QTY_WK08 + SALES_BASE_ORDER_QTY_WK07 + SALES_BASE_ORDER_QTY_WK06 + SALES_BASE_ORDER_QTY_WK05 + SALES_BASE_ORDER_QTY_WK04 + SALES_BASE_ORDER_QTY_WK03 + SALES_BASE_ORDER_QTY_WK02 + SALES_BASE_ORDER_QTY_WK01)/8))/2))/
((((FRCST_00_PLAN_QTY_FUT_WK02 + FRCST_00_PLAN_QTY_FUT_WK03 + FRCST_00_PLAN_QTY_FUT_WK04 + FRCST_00_PLAN_QTY_FUT_WK05)/4) + ((FRCST_00_PLAN_QTY_FUT_WK02 + FRCST_00_PLAN_QTY_FUT_WK03 + FRCST_00_PLAN_QTY_FUT_WK04 + FRCST_00_PLAN_QTY_FUT_WK05 + FRCST_00_PLAN_QTY_FUT_WK06 + FRCST_00_PLAN_QTY_FUT_WK07 + FRCST_00_PLAN_QTY_FUT_WK08 + FRCST_00_PLAN_QTY_FUT_WK09)/8))/2))) as V00_to_Intake_Percentage_Diff,

DECODE((FRCST_55_PLAN_QTY_FUT_WK01 + FRCST_55_PLAN_QTY_FUT_WK02 + FRCST_55_PLAN_QTY_FUT_WK03 + FRCST_55_PLAN_QTY_FUT_WK04 + FRCST_55_PLAN_QTY_FUT_WK05 + FRCST_55_PLAN_QTY_FUT_WK06 + FRCST_55_PLAN_QTY_FUT_WK07 + FRCST_55_PLAN_QTY_FUT_WK08 + FRCST_55_PLAN_QTY_FUT_WK09 + FRCST_55_PLAN_QTY_FUT_WK10 + FRCST_55_PLAN_QTY_FUT_WK11 + FRCST_55_PLAN_QTY_FUT_WK12 + FRCST_55_PLAN_QTY_FUT_WK13)/13,0,0,((((FRCST_55_PLAN_QTY_FUT_WK01 + FRCST_55_PLAN_QTY_FUT_WK02 + FRCST_55_PLAN_QTY_FUT_WK03 + FRCST_55_PLAN_QTY_FUT_WK04 + FRCST_55_PLAN_QTY_FUT_WK05 + FRCST_55_PLAN_QTY_FUT_WK06 + FRCST_55_PLAN_QTY_FUT_WK07 + FRCST_55_PLAN_QTY_FUT_WK08 + FRCST_55_PLAN_QTY_FUT_WK09 + FRCST_55_PLAN_QTY_FUT_WK10 + FRCST_55_PLAN_QTY_FUT_WK11 + FRCST_55_PLAN_QTY_FUT_WK12 + FRCST_55_PLAN_QTY_FUT_WK13)/13) - ((((SALES_BASE_ORDER_QTY_WK04 + SALES_BASE_ORDER_QTY_WK03 + SALES_BASE_ORDER_QTY_WK02 + SALES_BASE_ORDER_QTY_WK01)/4) + ((SALES_BASE_ORDER_QTY_WK08 + SALES_BASE_ORDER_QTY_WK07 + SALES_BASE_ORDER_QTY_WK06 + SALES_BASE_ORDER_QTY_WK05 + SALES_BASE_ORDER_QTY_WK04 + SALES_BASE_ORDER_QTY_WK03 + SALES_BASE_ORDER_QTY_WK02 + SALES_BASE_ORDER_QTY_WK01)/8))/2))/ 
((FRCST_55_PLAN_QTY_FUT_WK01 + FRCST_55_PLAN_QTY_FUT_WK02 + FRCST_55_PLAN_QTY_FUT_WK03 + FRCST_55_PLAN_QTY_FUT_WK04 + FRCST_55_PLAN_QTY_FUT_WK05 + FRCST_55_PLAN_QTY_FUT_WK06 + FRCST_55_PLAN_QTY_FUT_WK07 + FRCST_55_PLAN_QTY_FUT_WK08 + FRCST_55_PLAN_QTY_FUT_WK09 + FRCST_55_PLAN_QTY_FUT_WK10 + FRCST_55_PLAN_QTY_FUT_WK11 + FRCST_55_PLAN_QTY_FUT_WK12 + FRCST_55_PLAN_QTY_FUT_WK13)/13))) as V55_to_Intake_Percentage_Diff,

(((((FRCST_00_PLAN_QTY_FUT_WK02 + FRCST_00_PLAN_QTY_FUT_WK03 + FRCST_00_PLAN_QTY_FUT_WK04 + FRCST_00_PLAN_QTY_FUT_WK05)/4) + ((FRCST_00_PLAN_QTY_FUT_WK02 + FRCST_00_PLAN_QTY_FUT_WK03 + FRCST_00_PLAN_QTY_FUT_WK04 + FRCST_00_PLAN_QTY_FUT_WK05 + FRCST_00_PLAN_QTY_FUT_WK06 + FRCST_00_PLAN_QTY_FUT_WK07 + FRCST_00_PLAN_QTY_FUT_WK08 + FRCST_00_PLAN_QTY_FUT_WK09)/8))/2) - ((((SALES_BASE_ORDER_QTY_WK04 + SALES_BASE_ORDER_QTY_WK03 + SALES_BASE_ORDER_QTY_WK02 + SALES_BASE_ORDER_QTY_WK01)/4) + ((SALES_BASE_ORDER_QTY_WK08 + SALES_BASE_ORDER_QTY_WK07 + SALES_BASE_ORDER_QTY_WK06 + SALES_BASE_ORDER_QTY_WK05 + SALES_BASE_ORDER_QTY_WK04 + SALES_BASE_ORDER_QTY_WK03 + SALES_BASE_ORDER_QTY_WK02 + SALES_BASE_ORDER_QTY_WK01)/8))/2)) as V00_to_Intake_qty_Difference,
(((FRCST_55_PLAN_QTY_FUT_WK01 + FRCST_55_PLAN_QTY_FUT_WK02 + FRCST_55_PLAN_QTY_FUT_WK03 + FRCST_55_PLAN_QTY_FUT_WK04 + FRCST_55_PLAN_QTY_FUT_WK05 + FRCST_55_PLAN_QTY_FUT_WK06 + FRCST_55_PLAN_QTY_FUT_WK07 + FRCST_55_PLAN_QTY_FUT_WK08 + FRCST_55_PLAN_QTY_FUT_WK09 + FRCST_55_PLAN_QTY_FUT_WK10 + FRCST_55_PLAN_QTY_FUT_WK11 + FRCST_55_PLAN_QTY_FUT_WK12 + FRCST_55_PLAN_QTY_FUT_WK13)/13) - ((((SALES_BASE_ORDER_QTY_WK04 + SALES_BASE_ORDER_QTY_WK03 + SALES_BASE_ORDER_QTY_WK02 + SALES_BASE_ORDER_QTY_WK01)/4) + ((SALES_BASE_ORDER_QTY_WK08 + SALES_BASE_ORDER_QTY_WK07 + SALES_BASE_ORDER_QTY_WK06 + SALES_BASE_ORDER_QTY_WK05 + SALES_BASE_ORDER_QTY_WK04 + SALES_BASE_ORDER_QTY_WK03 + SALES_BASE_ORDER_QTY_WK02 + SALES_BASE_ORDER_QTY_WK01)/8))/2)) as V55_to_Intake_qty_Difference,

(((FRCST_00_PLAN_QTY_FUT_WK02 + FRCST_00_PLAN_QTY_FUT_WK03 + FRCST_00_PLAN_QTY_FUT_WK04 + FRCST_00_PLAN_QTY_FUT_WK05 + FRCST_00_PLAN_QTY_FUT_WK06 + FRCST_00_PLAN_QTY_FUT_WK07 + FRCST_00_PLAN_QTY_FUT_WK08 + FRCST_00_PLAN_QTY_FUT_WK09)/8)/5) as Daily_V00,
(((FRCST_55_PLAN_QTY_FUT_WK01 + FRCST_55_PLAN_QTY_FUT_WK02 + FRCST_55_PLAN_QTY_FUT_WK03 + FRCST_55_PLAN_QTY_FUT_WK04 + FRCST_55_PLAN_QTY_FUT_WK05 + FRCST_55_PLAN_QTY_FUT_WK06 + FRCST_55_PLAN_QTY_FUT_WK07 + FRCST_55_PLAN_QTY_FUT_WK08 + FRCST_55_PLAN_QTY_FUT_WK09 + FRCST_55_PLAN_QTY_FUT_WK10 + FRCST_55_PLAN_QTY_FUT_WK11 + FRCST_55_PLAN_QTY_FUT_WK12 + FRCST_55_PLAN_QTY_FUT_WK13)/13)/5) as Daily_V55,

((((FRCST_00_PLAN_QTY_FUT_WK02 + FRCST_00_PLAN_QTY_FUT_WK03 + FRCST_00_PLAN_QTY_FUT_WK04 + FRCST_00_PLAN_QTY_FUT_WK05 + FRCST_00_PLAN_QTY_FUT_WK06 + FRCST_00_PLAN_QTY_FUT_WK07 + FRCST_00_PLAN_QTY_FUT_WK08 + FRCST_00_PLAN_QTY_FUT_WK09)/8)/5)-(((FRCST_55_PLAN_QTY_FUT_WK01 + FRCST_55_PLAN_QTY_FUT_WK02 + FRCST_55_PLAN_QTY_FUT_WK03 + FRCST_55_PLAN_QTY_FUT_WK04 + FRCST_55_PLAN_QTY_FUT_WK05 + FRCST_55_PLAN_QTY_FUT_WK06 + FRCST_55_PLAN_QTY_FUT_WK07 + FRCST_55_PLAN_QTY_FUT_WK08 + FRCST_55_PLAN_QTY_FUT_WK09 + FRCST_55_PLAN_QTY_FUT_WK10 + FRCST_55_PLAN_QTY_FUT_WK11 + FRCST_55_PLAN_QTY_FUT_WK12 + FRCST_55_PLAN_QTY_FUT_WK13)/13)/5)) as Daily_V55_vs_V00, 


SAFETY_STK,
LOT_SIZE,
UNIT_COST,
SAFETY_STK as MIN_INVENTORY,
((0.5 * LOT_SIZE)+ SAFETY_STK) as TARGET_INVENTORY_QTY,
((1 * LOT_SIZE) + SAFETY_STK) as MAX_INVENTORY_QTY,
DC_OH_QTY,
(SAFETY_STK * UNIT_COST) as MIN_INVENTORY_$$,
(((0.5 * LOT_SIZE)+ SAFETY_STK) * UNIT_COST) as TARGET_INVENTORY_$$,
(((1 * LOT_SIZE) + SAFETY_STK) * UNIT_COST) as MAX_INVENTORY_$$,
DC_OH_QTY * UNIT_COST as OH_INVENTORY_$$,
DC_OH_QTY - TARGET_INVENTORY_RANK_WK_13 as OVER_TARGET_QTY,
DC_OH_QTY - MAX_INVENTORY_RANK_WK_13 as OVER_MAX_QTY,
(DC_OH_QTY - TARGET_INVENTORY_RANK_WK_13) * UNIT_COST as OVER_TARGET_$$,
(DC_OH_QTY - MAX_INVENTORY_RANK_WK_13) * UNIT_COST as OVER_MAX_$$,
OH_WEEK12,
OH_WEEK11,
OH_WEEK10,
OH_WEEK09,
OH_WEEK08,
OH_WEEK07,
OH_WEEK06,
OH_WEEK05,
OH_WEEK04,
OH_WEEK03,
OH_WEEK02,
OH_WEEK01,
DC_OH_QTY as OH_QTY_CURR_WEEK,
MAX_INVENTORY_RANK_WK_12,
MAX_INVENTORY_RANK_WK_11,
MAX_INVENTORY_RANK_WK_10,
MAX_INVENTORY_RANK_WK_09,
MAX_INVENTORY_RANK_WK_08,
MAX_INVENTORY_RANK_WK_07,
MAX_INVENTORY_RANK_WK_06,
MAX_INVENTORY_RANK_WK_05,
MAX_INVENTORY_RANK_WK_04,
MAX_INVENTORY_RANK_WK_03,
MAX_INVENTORY_RANK_WK_02,
MAX_INVENTORY_RANK_WK_01,
((1 * LOT_SIZE) + SAFETY_STK) as MAX_INVENTORY_QTY_CURR_WEEK,
TARGET_INVENTORY_RANK_WK_12,
TARGET_INVENTORY_RANK_WK_11,
TARGET_INVENTORY_RANK_WK_10,
TARGET_INVENTORY_RANK_WK_09,
TARGET_INVENTORY_RANK_WK_08,
TARGET_INVENTORY_RANK_WK_07,
TARGET_INVENTORY_RANK_WK_06,
TARGET_INVENTORY_RANK_WK_05,
TARGET_INVENTORY_RANK_WK_04,
TARGET_INVENTORY_RANK_WK_03,
TARGET_INVENTORY_RANK_WK_02,
TARGET_INVENTORY_RANK_WK_01,
((0.5 * LOT_SIZE)+ SAFETY_STK) as TARGET_INVENTORY_QTY_CURR_WEEK,
MIN_INVENTORY_RANK_WK_12,
MIN_INVENTORY_RANK_WK_11,
MIN_INVENTORY_RANK_WK_10,
MIN_INVENTORY_RANK_WK_09,
MIN_INVENTORY_RANK_WK_08,
MIN_INVENTORY_RANK_WK_07,
MIN_INVENTORY_RANK_WK_06,
MIN_INVENTORY_RANK_WK_05,
MIN_INVENTORY_RANK_WK_04,
MIN_INVENTORY_RANK_WK_03,
MIN_INVENTORY_RANK_WK_02,
MIN_INVENTORY_RANK_WK_01,
SAFETY_STK as MIN_INVENTORY_QTY_CURR_WEEK,
OH_WEEK12_$$,
OH_WEEK11_$$,
OH_WEEK10_$$,
OH_WEEK09_$$,
OH_WEEK08_$$,
OH_WEEK07_$$,
OH_WEEK06_$$,
OH_WEEK05_$$,
OH_WEEK04_$$,
OH_WEEK03_$$,
OH_WEEK02_$$,
OH_WEEK01_$$,
(DC_OH_QTY * UNIT_COST)as OH_CURR_WEEK_$$,
TARGET_INVENTORY_RANK_WK_12 * UNIT_COST as TARGET_INVENTORY_RANK_WK_12_$$,
TARGET_INVENTORY_RANK_WK_11 * UNIT_COST as TARGET_INVENTORY_RANK_WK_11_$$,
TARGET_INVENTORY_RANK_WK_10 * UNIT_COST as TARGET_INVENTORY_RANK_WK_10_$$,
TARGET_INVENTORY_RANK_WK_09 * UNIT_COST as TARGET_INVENTORY_RANK_WK_09_$$,
TARGET_INVENTORY_RANK_WK_08 * UNIT_COST as TARGET_INVENTORY_RANK_WK_08_$$,
TARGET_INVENTORY_RANK_WK_07 * UNIT_COST as TARGET_INVENTORY_RANK_WK_07_$$,
TARGET_INVENTORY_RANK_WK_06 * UNIT_COST as TARGET_INVENTORY_RANK_WK_06_$$,
TARGET_INVENTORY_RANK_WK_05 * UNIT_COST as TARGET_INVENTORY_RANK_WK_05_$$,
TARGET_INVENTORY_RANK_WK_04 * UNIT_COST as TARGET_INVENTORY_RANK_WK_04_$$,
TARGET_INVENTORY_RANK_WK_03 * UNIT_COST as TARGET_INVENTORY_RANK_WK_03_$$,
TARGET_INVENTORY_RANK_WK_02 * UNIT_COST as TARGET_INVENTORY_RANK_WK_02_$$,
TARGET_INVENTORY_RANK_WK_01 * UNIT_COST as TARGET_INVENTORY_RANK_WK_01_$$,
(((0.5 * LOT_SIZE)+ SAFETY_STK) * UNIT_COST) as TARGET_INVENTORY_CURR_WEEK_$$,
MAX_INVENTORY_RANK_WK_12 * UNIT_COST as MAX_INVENTORY_WK_12_$$,
MAX_INVENTORY_RANK_WK_11 * UNIT_COST as MAX_INVENTORY_WK_11_$$,
MAX_INVENTORY_RANK_WK_10 * UNIT_COST as MAX_INVENTORY_WK_10_$$,
MAX_INVENTORY_RANK_WK_09 * UNIT_COST as MAX_INVENTORY_WK_09_$$,
MAX_INVENTORY_RANK_WK_08 * UNIT_COST as MAX_INVENTORY_WK_08_$$,
MAX_INVENTORY_RANK_WK_07 * UNIT_COST as MAX_INVENTORY_WK_07_$$,
MAX_INVENTORY_RANK_WK_06 * UNIT_COST as MAX_INVENTORY_WK_06_$$,
MAX_INVENTORY_RANK_WK_05 * UNIT_COST as MAX_INVENTORY_WK_05_$$,
MAX_INVENTORY_RANK_WK_04 * UNIT_COST as MAX_INVENTORY_WK_04_$$,
MAX_INVENTORY_RANK_WK_03 * UNIT_COST as MAX_INVENTORY_WK_03_$$,
MAX_INVENTORY_RANK_WK_02 * UNIT_COST as MAX_INVENTORY_WK_02_$$,
MAX_INVENTORY_RANK_WK_01 * UNIT_COST as MAX_INVENTORY_WK_01_$$,
(((1 * LOT_SIZE) + SAFETY_STK)  * UNIT_COST) as MAX_INVENTORY_CURR_WEEK_$$,
(CASE WHEN OH_WEEK12 < MIN_INVENTORY_RANK_WK_12 THEN OH_WEEK12 ELSE MIN_INVENTORY_RANK_WK_12 END) AS BELOW_SS_WK_12,
(CASE WHEN OH_WEEK11 < MIN_INVENTORY_RANK_WK_11 THEN OH_WEEK11 ELSE MIN_INVENTORY_RANK_WK_11 END) AS BELOW_SS_WK_11,
(CASE WHEN OH_WEEK10 < MIN_INVENTORY_RANK_WK_10 THEN OH_WEEK10 ELSE MIN_INVENTORY_RANK_WK_10 END) AS BELOW_SS_WK_10,
(CASE WHEN OH_WEEK09 < MIN_INVENTORY_RANK_WK_09 THEN OH_WEEK09 ELSE MIN_INVENTORY_RANK_WK_09 END) AS BELOW_SS_WK_09,
(CASE WHEN OH_WEEK08 < MIN_INVENTORY_RANK_WK_08 THEN OH_WEEK08 ELSE MIN_INVENTORY_RANK_WK_08 END) AS BELOW_SS_WK_08,
(CASE WHEN OH_WEEK07 < MIN_INVENTORY_RANK_WK_07 THEN OH_WEEK07 ELSE MIN_INVENTORY_RANK_WK_07 END) AS BELOW_SS_WK_07,
(CASE WHEN OH_WEEK06 < MIN_INVENTORY_RANK_WK_06 THEN OH_WEEK06 ELSE MIN_INVENTORY_RANK_WK_06 END) AS BELOW_SS_WK_06,
(CASE WHEN OH_WEEK05 < MIN_INVENTORY_RANK_WK_05 THEN OH_WEEK05 ELSE MIN_INVENTORY_RANK_WK_05 END) AS BELOW_SS_WK_05,
(CASE WHEN OH_WEEK04 < MIN_INVENTORY_RANK_WK_04 THEN OH_WEEK04 ELSE MIN_INVENTORY_RANK_WK_04 END) AS BELOW_SS_WK_04,
(CASE WHEN OH_WEEK03 < MIN_INVENTORY_RANK_WK_03 THEN OH_WEEK03 ELSE MIN_INVENTORY_RANK_WK_03 END) AS BELOW_SS_WK_03,
(CASE WHEN OH_WEEK02 < MIN_INVENTORY_RANK_WK_02 THEN OH_WEEK02 ELSE MIN_INVENTORY_RANK_WK_02 END) AS BELOW_SS_WK_02,
(CASE WHEN OH_WEEK01 < MIN_INVENTORY_RANK_WK_01 THEN OH_WEEK01 ELSE MIN_INVENTORY_RANK_WK_01 END) AS BELOW_SS_WK_01,
(CASE WHEN DC_OH_QTY < SAFETY_STK THEN DC_OH_QTY ELSE SAFETY_STK END) AS BELOW_SS_CURR_WK,
(CASE WHEN OH_WEEK12 > MIN_INVENTORY_RANK_WK_12 THEN (OH_WEEK12-MIN_INVENTORY_RANK_WK_12) ELSE 0 END) AS ABOVE_SS_WK_12,
(CASE WHEN OH_WEEK11 > MIN_INVENTORY_RANK_WK_11 THEN (OH_WEEK11-MIN_INVENTORY_RANK_WK_11) ELSE 0 END) AS ABOVE_SS_WK_11,
(CASE WHEN OH_WEEK10 > MIN_INVENTORY_RANK_WK_10 THEN (OH_WEEK10-MIN_INVENTORY_RANK_WK_10) ELSE 0 END) AS ABOVE_SS_WK_10,
(CASE WHEN OH_WEEK09 > MIN_INVENTORY_RANK_WK_09 THEN (OH_WEEK09-MIN_INVENTORY_RANK_WK_09) ELSE 0 END) AS ABOVE_SS_WK_09,
(CASE WHEN OH_WEEK08 > MIN_INVENTORY_RANK_WK_08 THEN (OH_WEEK08-MIN_INVENTORY_RANK_WK_08) ELSE 0 END) AS ABOVE_SS_WK_08,
(CASE WHEN OH_WEEK07 > MIN_INVENTORY_RANK_WK_07 THEN (OH_WEEK07-MIN_INVENTORY_RANK_WK_07) ELSE 0 END) AS ABOVE_SS_WK_07,
(CASE WHEN OH_WEEK06 > MIN_INVENTORY_RANK_WK_06 THEN (OH_WEEK06-MIN_INVENTORY_RANK_WK_06) ELSE 0 END) AS ABOVE_SS_WK_06,
(CASE WHEN OH_WEEK05 > MIN_INVENTORY_RANK_WK_05 THEN (OH_WEEK05-MIN_INVENTORY_RANK_WK_05) ELSE 0 END) AS ABOVE_SS_WK_05,
(CASE WHEN OH_WEEK04 > MIN_INVENTORY_RANK_WK_04 THEN (OH_WEEK04-MIN_INVENTORY_RANK_WK_04) ELSE 0 END) AS ABOVE_SS_WK_04,
(CASE WHEN OH_WEEK03 > MIN_INVENTORY_RANK_WK_03 THEN (OH_WEEK03-MIN_INVENTORY_RANK_WK_03) ELSE 0 END) AS ABOVE_SS_WK_03,
(CASE WHEN OH_WEEK02 > MIN_INVENTORY_RANK_WK_02 THEN (OH_WEEK02-MIN_INVENTORY_RANK_WK_02) ELSE 0 END) AS ABOVE_SS_WK_02,
(CASE WHEN OH_WEEK01 > MIN_INVENTORY_RANK_WK_01 THEN (OH_WEEK01-MIN_INVENTORY_RANK_WK_01) ELSE 0 END) AS ABOVE_SS_WK_01,
(CASE WHEN DC_OH_QTY > SAFETY_STK THEN (DC_OH_QTY-SAFETY_STK) ELSE 0 END) AS ABOVE_SS_CURR_WK

--((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13) AS AVG_13wks_EXTERNAL_$$,

--DECODE(((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13),0,0,((OH_WEEK12_$$/((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13))*7)) AS DOH_WK_13,

--DECODE(((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13),0,0,((OH_WEEK11_$$/((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13))*7)) AS DOH_WK_12,

--DECODE(((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13),0,0,((OH_WEEK10_$$/((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13))*7)) AS DOH_WK_11,

--DECODE(((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13),0,0,((OH_WEEK09_$$/((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13))*7)) AS DOH_WK_10,

--DECODE(((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13),0,0,((OH_WEEK08_$$/((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13))*7)) AS DOH_WK_09,

--DECODE(((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13),0,0,((OH_WEEK07_$$/((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13))*7)) AS DOH_WK_08,

--DECODE(((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13),0,0,((OH_WEEK06_$$/((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13))*7)) AS DOH_WK_07,

--DECODE(((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13),0,0,((OH_WEEK05_$$/((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13))*7)) AS DOH_WK_06,

--DECODE(((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13),0,0,((OH_WEEK04_$$/((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13))*7)) AS DOH_WK_05,

--DECODE(((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13),0,0,((OH_WEEK03_$$/((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13))*7)) AS DOH_WK_04,

--DECODE(((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13),0,0,((OH_WEEK02_$$/((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13))*7)) AS DOH_WK_03,

--DECODE(((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13),0,0,((OH_WEEK01_$$/((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13))*7)) AS DOH_WK_02,

--DECODE(((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13),0,0,(((DC_OH_QTY * UNIT_COST)/((EXTERNAL_USE_WEEK13_$$ + EXTERNAL_USE_WEEK12_$$ + EXTERNAL_USE_WEEK11_$$ + EXTERNAL_USE_WEEK10_$$ + EXTERNAL_USE_WEEK09_$$ + EXTERNAL_USE_WEEK08_$$ + EXTERNAL_USE_WEEK07_$$ + EXTERNAL_USE_WEEK06_$$ + EXTERNAL_USE_WEEK05_$$ +
--EXTERNAL_USE_WEEK04_$$ + EXTERNAL_USE_WEEK03_$$ + EXTERNAL_USE_WEEK02_$$ + EXTERNAL_USE_WEEK01_$$)/13))*7)) AS DOH_FOR_THIS_WEEK


---DOH CHARTS---
--DECODE((((TOTAL_BASE_ORDER_QTY_WK13 + TOTAL_BASE_ORDER_QTY_WK12 + TOTAL_BASE_ORDER_QTY_WK11 + TOTAL_BASE_ORDER_QTY_WK10 + TOTAL_BASE_ORDER_QTY_WK09 + TOTAL_BASE_ORDER_QTY_WK08 + TOTAL_BASE_ORDER_QTY_WK07 + TOTAL_BASE_ORDER_QTY_WK06 + TOTAL_BASE_ORDER_QTY_WK05 + TOTAL_BASE_ORDER_QTY_WK04 + TOTAL_BASE_ORDER_QTY_WK03 + TOTAL_BASE_ORDER_QTY_WK02 + TOTAL_BASE_ORDER_QTY_WK01) * UNIT_COST)/90),0,0,
--((DC_OH_QTY * UNIT_COST)/(((TOTAL_BASE_ORDER_QTY_WK13 + TOTAL_BASE_ORDER_QTY_WK12 + TOTAL_BASE_ORDER_QTY_WK11 + TOTAL_BASE_ORDER_QTY_WK10 + TOTAL_BASE_ORDER_QTY_WK09 + TOTAL_BASE_ORDER_QTY_WK08 + TOTAL_BASE_ORDER_QTY_WK07 + TOTAL_BASE_ORDER_QTY_WK06 + TOTAL_BASE_ORDER_QTY_WK05 + TOTAL_BASE_ORDER_QTY_WK04 + TOTAL_BASE_ORDER_QTY_WK03 + TOTAL_BASE_ORDER_QTY_WK02 + TOTAL_BASE_ORDER_QTY_WK01) * UNIT_COST)/90))) AS DOH_FOR_THIS_WEEK,

--DECODE((((TOTAL_BASE_ORDER_QTY_WK13 + TOTAL_BASE_ORDER_QTY_WK12 + TOTAL_BASE_ORDER_QTY_WK11 + TOTAL_BASE_ORDER_QTY_WK10 + TOTAL_BASE_ORDER_QTY_WK09 + TOTAL_BASE_ORDER_QTY_WK08 + TOTAL_BASE_ORDER_QTY_WK07 + TOTAL_BASE_ORDER_QTY_WK06 + TOTAL_BASE_ORDER_QTY_WK05 + TOTAL_BASE_ORDER_QTY_WK04 + TOTAL_BASE_ORDER_QTY_WK03 + TOTAL_BASE_ORDER_QTY_WK02 + TOTAL_BASE_ORDER_QTY_WK01) * UNIT_COST)/90),0,0,
--((((0.5 * LOT_SIZE)+ SAFETY_STK) * UNIT_COST)/(((TOTAL_BASE_ORDER_QTY_WK13 + TOTAL_BASE_ORDER_QTY_WK12 + TOTAL_BASE_ORDER_QTY_WK11 + TOTAL_BASE_ORDER_QTY_WK10 + TOTAL_BASE_ORDER_QTY_WK09 + TOTAL_BASE_ORDER_QTY_WK08 + TOTAL_BASE_ORDER_QTY_WK07 + TOTAL_BASE_ORDER_QTY_WK06 + TOTAL_BASE_ORDER_QTY_WK05 + TOTAL_BASE_ORDER_QTY_WK04 + TOTAL_BASE_ORDER_QTY_WK03 + TOTAL_BASE_ORDER_QTY_WK02 + TOTAL_BASE_ORDER_QTY_WK01) * UNIT_COST)/90))) AS TARGET_DOH_FOR_THIS_WEEK,

--DECODE((((TOTAL_BASE_ORDER_QTY_WK13 + TOTAL_BASE_ORDER_QTY_WK12 + TOTAL_BASE_ORDER_QTY_WK11 + TOTAL_BASE_ORDER_QTY_WK10 + TOTAL_BASE_ORDER_QTY_WK09 + TOTAL_BASE_ORDER_QTY_WK08 + TOTAL_BASE_ORDER_QTY_WK07 + TOTAL_BASE_ORDER_QTY_WK06 + TOTAL_BASE_ORDER_QTY_WK05 + TOTAL_BASE_ORDER_QTY_WK04 + TOTAL_BASE_ORDER_QTY_WK03 + TOTAL_BASE_ORDER_QTY_WK02 + TOTAL_BASE_ORDER_QTY_WK01) * UNIT_COST)/90),0,0,
--((((1.2 * LOT_SIZE) + SAFETY_STK) * UNIT_COST)/(((TOTAL_BASE_ORDER_QTY_WK13 + TOTAL_BASE_ORDER_QTY_WK12 + TOTAL_BASE_ORDER_QTY_WK11 + TOTAL_BASE_ORDER_QTY_WK10 + TOTAL_BASE_ORDER_QTY_WK09 + TOTAL_BASE_ORDER_QTY_WK08 + TOTAL_BASE_ORDER_QTY_WK07 + TOTAL_BASE_ORDER_QTY_WK06 + TOTAL_BASE_ORDER_QTY_WK05 + TOTAL_BASE_ORDER_QTY_WK04 + TOTAL_BASE_ORDER_QTY_WK03 + TOTAL_BASE_ORDER_QTY_WK02 + TOTAL_BASE_ORDER_QTY_WK01) * UNIT_COST)/90))) AS MAX_DOH_FOR_THIS_WEEK

from DWQ$LIBRARIAN.INV_SAP_TOP_90_BUILD@ROCKWELL_DW_DBLINK
where EXPECTED_SHIP_PLANT in ('1090','4000','5040')
AND SUBSTR(VENDOR_NAME, 1, 4) in ('5010','5170');
